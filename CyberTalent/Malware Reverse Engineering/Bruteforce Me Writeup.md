# Bruteforce Me: A CTF Challenge Writeup

## Table of Contents
1. Challenge Description
2. Code Analysis
3. Understanding the Code's Purpose
4. Reversing the Process
5. Automating the Conversion Process
6. Bruteforce Approach


## Challenge Description

flag format flag{xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx},only a-z,0-9,_ are allowed. try to find the only flag that makes sense. Note: no special hardware is required to bruteforce https://www.youtube.com/watch?v=hyk46UmJPS4 this may help you coding the solution. DON'T BRUTEFORCE KEY SUBMISSIONS.

### Provided file
[Python code](https://s3-eu-west-1.amazonaws.com/hubchallenges/Reverse/bruteforceme.py) was provided with the challange:

```Python
ll =[51, 54, 48, 51, 61, 57, 50, 54, 48, 52, 55, 50, 50, 57, 47, 52, 57, 47, 54, 24, 57, 58, 62]

i = raw_input()
ss= 0 
try:
    for ii in range(0,46 , 2):
        temp = i[ii:ii+2]
        temp = int(temp,0x10)
        ss+=temp
        temp >>=1
        if temp != ll[ii/2]:
            print "Something is wrong"
    if ss !=2406:
            print ss/0
    print "This flag may or may not work, can you find more ?"
        
except:
    print "NO"

```

## Code Analysis and Explanation

1. `i` stores user input.
2. `ss` stores the sum.
3. `for ii in range(0,46 , 2):` This loop iterates over the array `ll` in steps of 2, starting from 0 and ending at 44.
4. `temp = i[ii:ii+2]` This line slices 2 characters from the user input. In this case, it takes 2 HEX numbers, as we can infer from the next line.
5. `temp = int(temp,0x10)` This line converts HEX to a decimal value.
6. `ss+=temp` This line adds the decimal value to `ss` to calculate the sum.
7. `temp >>=1` This line performs a right shift on the decimal number, which is equivalent to dividing it by 2. Read this article if you want to learn more about Shift Operators.
8. `if temp != ll[ii/2]:` This line checks if the decimal number after shifting is equal to the item in the `ll` list. If not, it prints **Something is wrong**.
9. After it finishes the loop, it checks if the sum of the decimal numbers is equal to 2406. If not, it divides it by 0 to raise an exception and break out of the program.




## Understanding the Codeâ€™s Purpose

The script takes a HEX input from the user, converts it to a decimal number, adds it to `ss`, then divides it by 2 and checks if that number equals the corresponding number in the `ll` list. If true, it continues the loop. Then, at the end, it checks whether or not the `ss` sum is equal to 2406. For example, the first item in the list, which is 55, is the decimal equivalent of a number a user entered after dividing it by 2.

## Reversing the Process: An Example
1. Multiply the first number in list by 2 `51 * 2 = 102`
2. We can either convert it to HEX or leave it in decimal. Either way, we can view the [ASCII table](https://www.asciitable.com/) to see the char equivalent of that number, which will be `f`.



## Automating the Conversion Process: Script Creation
We need to create a script to automate this conversion process.
```Python
ll =[51, 54, 48, 51, 61, 57, 50, 54, 48, 52, 55, 50, 50, 57, 47, 52, 57, 47, 54, 24, 57, 58, 62]

llDouble = [i * 2 for i in ll]
flag = ""
sum = 0

for c in range(23):
    flag += chr(llDouble[c])
    sum += llDouble[c]

print(sum)
print(flag)
```
```
2392
fl`fzrdl`hnddr^hr^l0rt|
```
As you can see, the sum is not 2406, which means there are numbers that are higher because the right shift operation (step number 7) doesn't take decimal points into consideration. If you look at the character ` which is equivalent to 48 in the list and check the ASCII table, you will see that 96 equals this character and 97 is "a". Looking back at the description of the challenge, the goal is to bruteforce it and find a flag that makes sense.

## Bruteforce Approach to Solve the Challenge
There are a lot of ways to bruteforce it, but I chose the simplest and fastest one, which is to compare the output of the first flag and the output of the same flag but after adding 1 to the numbers.
```Python
ll =[51, 54, 48, 51, 61, 57, 50, 54, 48, 52, 55, 50, 50, 57, 47, 52, 57, 47, 54, 24, 57, 58, 62]

llDouble = [i * 2 for i in ll]
llPlusOne = [i + 1 for i in llDouble]

flag1 = ""
flag2 = ""

for c in range(23):
    flag1 +=chr(llDouble[c])
    flag1 +=chr(llPlusOne[c])

print(flag1)
print(flag2)
```
```
fl`fzrdl`hnddr^hr^l0rt|
gmag{semaioees_is_m1su}
```
Also, you can print each character side by side to compare it better if you can't see the right flag yet, but it's visible for me :grin:

### FLAG
```Text
flag{remainder_is_l0st}
```
<p align="center">
  <img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExZnlsNTNud2Ywb2V6Mnp3Zmt2a2dpbHRpb2x1bDZiMHN5ZjVlOG11aCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/3oFzmqN1xHwaEXGl7q/giphy.gif
" alt="THE END" />
</p>

